<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>German Study Habit Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0a0a0a;
            min-height: 100vh;
            padding: 20px;
            color: #e0e0e0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #1a1a1a;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            border: 1px solid #2a2a2a;
        }

        h1 {
            text-align: center;
            color: #ffffff;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            padding: 20px 0;
            margin-bottom: 30px;
        }

        .stat-item {
            background: #252525;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid #333;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            display: block;
            color: #4ade80;
        }

        .stat-label {
            font-size: 0.9em;
            color: #888;
            margin-top: 5px;
        }

        .backup-section {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        .backup-btn {
            padding: 12px 30px;
            background: #252525;
            color: #e0e0e0;
            border: 1px solid #333;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1em;
            transition: all 0.3s;
        }

        .backup-btn:hover {
            background: #303030;
            border-color: #4ade80;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            .stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .section {
            background: #252525;
            padding: 20px;
            border-radius: 15px;
            border: 1px solid #333;
        }

        .section h2 {
            color: #ffffff;
            margin-bottom: 20px;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .add-task-form {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .add-task-form input {
            flex: 1;
            padding: 12px;
            border: 1px solid #333;
            border-radius: 8px;
            font-size: 1em;
            background: #1a1a1a;
            color: #e0e0e0;
        }

        .add-task-form input:focus {
            outline: none;
            border-color: #4ade80;
        }

        .add-task-form button {
            padding: 12px 24px;
            background: #4ade80;
            color: #0a0a0a;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
        }

        .add-task-form button:hover {
            background: #22c55e;
        }

        .task-list {
            list-style: none;
        }

        .task-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px;
            background: #1a1a1a;
            border-radius: 10px;
            margin-bottom: 10px;
            transition: transform 0.2s;
            border: 1px solid #333;
        }

        .task-item:hover {
            transform: translateX(5px);
            border-color: #4ade80;
        }

        .task-item.completed {
            opacity: 0.6;
        }

        .task-item input[type="checkbox"] {
            width: 24px;
            height: 24px;
            cursor: pointer;
            accent-color: #4ade80;
        }

        .task-item span {
            flex: 1;
            font-size: 1.1em;
            color: #e0e0e0;
        }

        .task-item.completed span {
            text-decoration: line-through;
            color: #666;
        }

        .delete-btn {
            background: #ef4444;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            transition: background 0.3s;
        }

        .delete-btn:hover {
            background: #dc2626;
        }

        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }

        .calendar-header {
            text-align: center;
            font-weight: bold;
            padding: 10px;
            color: #888;
            font-size: 0.9em;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #1a1a1a;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s;
            border: 1px solid #333;
            font-size: 0.9em;
        }

        .calendar-day:hover {
            transform: scale(1.05);
        }

        .calendar-day.completed {
            background: #166534;
            color: white;
            border-color: #4ade80;
        }

        .calendar-day.incomplete {
            background: #7f1d1d;
            color: white;
            border-color: #ef4444;
        }

        .calendar-day.today {
            border: 2px solid #4ade80;
            font-weight: bold;
        }

        .calendar-day.future {
            background: #0a0a0a;
            color: #555;
        }

        .day-number {
            font-size: 1.2em;
            font-weight: bold;
        }

        .day-status {
            font-size: 0.7em;
            margin-top: 2px;
        }

        .month-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .month-nav button {
            padding: 8px 16px;
            background: #252525;
            color: #e0e0e0;
            border: 1px solid #333;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .month-nav button:hover {
            background: #303030;
            border-color: #4ade80;
        }

        .current-month {
            font-size: 1.3em;
            font-weight: bold;
            color: #ffffff;
        }

        .no-tasks {
            text-align: center;
            color: #666;
            padding: 20px;
            font-style: italic;
        }

        .target-section {
            background: #252525;
            padding: 20px;
            border-radius: 15px;
            border: 1px solid #333;
            margin-bottom: 30px;
        }

        .target-section h3 {
            color: #ffffff;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .target-input-group {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .target-input-group input {
            padding: 10px;
            border: 1px solid #333;
            border-radius: 8px;
            background: #1a1a1a;
            color: #e0e0e0;
            width: 100px;
        }

        .target-input-group input:focus {
            outline: none;
            border-color: #4ade80;
        }

        .target-input-group button {
            padding: 10px 20px;
            background: #4ade80;
            color: #0a0a0a;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
        }

        .target-input-group button:hover {
            background: #22c55e;
        }

        .target-display {
            margin-top: 15px;
            padding: 15px;
            background: #1a1a1a;
            border-radius: 8px;
            border: 1px solid #333;
        }

        .target-display p {
            color: #e0e0e0;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #0a0a0a;
            border-radius: 15px;
            overflow: hidden;
            border: 1px solid #333;
        }

        .progress-fill {
            height: 100%;
            background: #4ade80;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #0a0a0a;
            font-weight: bold;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üá©üá™ German Study Tracker</h1>
        <p class="subtitle">Track your daily study habits and watch your progress grow!</p>

        <div class="target-section">
            <h3>üéØ Set Your Target</h3>
            <div class="target-input-group">
                <label style="color: #888;">Target Level:</label>
                <select id="targetLevel" style="padding: 10px; border: 1px solid #333; border-radius: 8px; background: #1a1a1a; color: #e0e0e0;">
                    <option value="A1">A1</option>
                    <option value="A2">A2</option>
                    <option value="B1">B1</option>
                    <option value="B2">B2</option>
                    <option value="C1" selected>C1</option>
                    <option value="C2">C2</option>
                </select>
                <label style="color: #888;">Target Date:</label>
                <input type="date" id="targetDate" value="2027-07-01">
                <button onclick="setTarget()">Set Target</button>
            </div>
            <div class="target-display" id="targetDisplay"></div>
        </div>

        <div class="stats">
            <div class="stat-item">
                <span class="stat-number" id="streakCount">0</span>
                <span class="stat-label">Current Streak üî•</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="longestStreak">0</span>
                <span class="stat-label">Longest Streak üèÜ</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="completedDays">0</span>
                <span class="stat-label">Days Completed ‚úÖ</span>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="totalHours">0</span>
                <span class="stat-label">Total Hours üìö</span>
            </div>
        </div>

        <div class="backup-section">
            <button class="backup-btn" onclick="exportData()">üì• Export Data</button>
            <button class="backup-btn" onclick="document.getElementById('importFile').click()">üì§ Import Data</button>
            <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importData(event)">
        </div>

        <div class="main-grid">
            <div class="section">
                <h2>üìù Today's Tasks</h2>
                <div class="add-task-form">
                    <input type="text" id="taskInput" placeholder="Add a new study task..." />
                    <button onclick="addTask()">Add</button>
                </div>
                <ul class="task-list" id="taskList"></ul>
            </div>

            <div class="section">
                <h2>üìÖ Study Calendar</h2>
                <div class="month-nav">
                    <button onclick="changeMonth(-1)">‚Üê Prev</button>
                    <span class="current-month" id="currentMonth"></span>
                    <button onclick="changeMonth(1)">Next ‚Üí</button>
                </div>
                <div class="calendar" id="calendar"></div>
            </div>
        </div>
    </div>

    <script>
        let tasks = {};
        let completionHistory = {};
        let targetData = null;
        let currentDate = new Date();
        let viewMonth = new Date();

        function getTodayKey() {
            return currentDate.toISOString().split('T')[0];
        }

        function loadData() {
            const savedTasks = JSON.parse(localStorage.getItem('germanStudyTasks') || '{}');
            const savedHistory = JSON.parse(localStorage.getItem('germanStudyHistory') || '{}');
            const savedTarget = JSON.parse(localStorage.getItem('germanStudyTarget') || 'null');
            tasks = savedTasks;
            completionHistory = savedHistory;
            targetData = savedTarget;
            
            if (targetData) {
                document.getElementById('targetLevel').value = targetData.level;
                document.getElementById('targetDate').value = targetData.date;
            }
        }

        function saveData() {
            localStorage.setItem('germanStudyTasks', JSON.stringify(tasks));
            localStorage.setItem('germanStudyHistory', JSON.stringify(completionHistory));
            if (targetData) {
                localStorage.setItem('germanStudyTarget', JSON.stringify(targetData));
            }
        }

        function setTarget() {
            const level = document.getElementById('targetLevel').value;
            const date = document.getElementById('targetDate').value;
            
            if (!date) {
                alert('Please select a target date!');
                return;
            }
            
            targetData = { level, date };
            saveData();
            updateTargetDisplay();
        }

        function updateTargetDisplay() {
            const display = document.getElementById('targetDisplay');
            
            if (!targetData) {
                display.innerHTML = '<p style="color: #666;">No target set yet. Set a target to track your progress!</p>';
                return;
            }
            
            const levelHours = {
                'A1': 100,
                'A2': 200,
                'B1': 400,
                'B2': 600,
                'C1': 800,
                'C2': 1000
            };
            
            const targetHours = levelHours[targetData.level];
            const taskCount = Object.keys(tasks).length;
            let completedDays = 0;
            
            Object.keys(completionHistory).forEach(dateKey => {
                const dayHistory = completionHistory[dateKey];
                const completedCount = Object.values(dayHistory).filter(v => v).length;
                if (taskCount > 0 && completedCount === taskCount) {
                    completedDays++;
                }
            });
            
            const currentHours = completedDays * 3;
            const progressPercent = Math.min((currentHours / targetHours) * 100, 100).toFixed(1);
            
            const targetDate = new Date(targetData.date);
            const today = new Date();
            const daysRemaining = Math.ceil((targetDate - today) / (1000 * 60 * 60 * 24));
            
            display.innerHTML = `
                <p><strong>Target:</strong> ${targetData.level} Level by ${new Date(targetData.date).toLocaleDateString()}</p>
                <p><strong>Progress:</strong> ${currentHours} / ${targetHours} hours</p>
                <p><strong>Days Remaining:</strong> ${daysRemaining > 0 ? daysRemaining : 'Target date passed!'}</p>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: ${progressPercent}%">${progressPercent}%</div>
                </div>
            `;
        }

        function addTask() {
            const input = document.getElementById('taskInput');
            const taskText = input.value.trim();
            
            if (taskText === '') {
                alert('Please enter a task!');
                return;
            }

            const taskId = Date.now().toString();
            if (!tasks[taskId]) {
                tasks[taskId] = {
                    text: taskText,
                    id: taskId
                };
            }

            input.value = '';
            saveData();
            renderTasks();
        }

        function deleteTask(taskId) {
            if (confirm('Delete this task? It will be removed from all future days.')) {
                delete tasks[taskId];
                
                Object.keys(completionHistory).forEach(date => {
                    if (completionHistory[date][taskId] !== undefined) {
                        delete completionHistory[date][taskId];
                    }
                });
                
                saveData();
                renderTasks();
                renderCalendar();
                updateStats();
                updateTargetDisplay();
            }
        }

        function toggleTask(taskId) {
            const today = getTodayKey();
            
            if (!completionHistory[today]) {
                completionHistory[today] = {};
            }

            completionHistory[today][taskId] = !completionHistory[today][taskId];
            
            saveData();
            renderTasks();
            renderCalendar();
            updateStats();
            updateTargetDisplay();
        }

        function renderTasks() {
            const taskList = document.getElementById('taskList');
            const today = getTodayKey();
            
            if (Object.keys(tasks).length === 0) {
                taskList.innerHTML = '<div class="no-tasks">No tasks yet. Add your first study task above!</div>';
                return;
            }

            taskList.innerHTML = '';
            
            Object.values(tasks).forEach(task => {
                const isCompleted = completionHistory[today]?.[task.id] || false;
                
                const li = document.createElement('li');
                li.className = 'task-item' + (isCompleted ? ' completed' : '');
                
                li.innerHTML = `
                    <input type="checkbox" ${isCompleted ? 'checked' : ''} 
                           onchange="toggleTask('${task.id}')">
                    <span>${task.text}</span>
                    <button class="delete-btn" onclick="deleteTask('${task.id}')">Delete</button>
                `;
                
                taskList.appendChild(li);
            });
        }

        function renderCalendar() {
            const calendar = document.getElementById('calendar');
            const year = viewMonth.getFullYear();
            const month = viewMonth.getMonth();
            
            document.getElementById('currentMonth').textContent = 
                viewMonth.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
            
            calendar.innerHTML = '';
            
            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            days.forEach(day => {
                const header = document.createElement('div');
                header.className = 'calendar-header';
                header.textContent = day;
                calendar.appendChild(header);
            });
            
            const firstDay = new Date(year, month, 1).getDay();
            
            for (let i = 0; i < firstDay; i++) {
                calendar.appendChild(document.createElement('div'));
            }
            
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const today = getTodayKey();
            
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month, day);
                const dateKey = date.toISOString().split('T')[0];
                const dayDiv = document.createElement('div');
                dayDiv.className = 'calendar-day';
                
                if (dateKey === today) {
                    dayDiv.classList.add('today');
                }
                
                if (date > currentDate) {
                    dayDiv.classList.add('future');
                } else {
                    const dayHistory = completionHistory[dateKey];
                    const taskCount = Object.keys(tasks).length;
                    
                    if (taskCount > 0 && dayHistory) {
                        const completedCount = Object.values(dayHistory).filter(v => v).length;
                        
                        if (completedCount === taskCount) {
                            dayDiv.classList.add('completed');
                            dayDiv.innerHTML = `
                                <span class="day-number">${day}</span>
                                <span class="day-status">‚úì</span>
                            `;
                        } else if (completedCount > 0) {
                            dayDiv.innerHTML = `
                                <span class="day-number">${day}</span>
                                <span class="day-status">${completedCount}/${taskCount}</span>
                            `;
                        } else {
                            dayDiv.classList.add('incomplete');
                            dayDiv.innerHTML = `
                                <span class="day-number">${day}</span>
                                <span class="day-status">‚úó</span>
                            `;
                        }
                    } else if (taskCount > 0 && dateKey !== today) {
                        dayDiv.classList.add('incomplete');
                        dayDiv.innerHTML = `
                            <span class="day-number">${day}</span>
                            <span class="day-status">‚úó</span>
                        `;
                    } else {
                        dayDiv.innerHTML = `<span class="day-number">${day}</span>`;
                    }
                }
                
                if (!dayDiv.innerHTML) {
                    dayDiv.innerHTML = `<span class="day-number">${day}</span>`;
                }
                
                calendar.appendChild(dayDiv);
            }
        }

        function changeMonth(direction) {
            viewMonth.setMonth(viewMonth.getMonth() + direction);
            renderCalendar();
        }

        function updateStats() {
            const taskCount = Object.keys(tasks).length;
            if (taskCount === 0) {
                document.getElementById('streakCount').textContent = '0';
                document.getElementById('longestStreak').textContent = '0';
                document.getElementById('completedDays').textContent = '0';
                document.getElementById('totalHours').textContent = '0';
                return;
            }

            // Calculate current streak
            let streak = 0;
            let checkDate = new Date(currentDate);
            
            while (true) {
                const dateKey = checkDate.toISOString().split('T')[0];
                const dayHistory = completionHistory[dateKey];
                
                if (dayHistory) {
                    const completedCount = Object.values(dayHistory).filter(v => v).length;
                    if (completedCount === taskCount) {
                        streak++;
                        checkDate.setDate(checkDate.getDate() - 1);
                    } else {
                        break;
                    }
                } else {
                    break;
                }
            }
            
            // Calculate longest streak
            let longestStreak = 0;
            let currentStreak = 0;
            const sortedDates = Object.keys(completionHistory).sort();
            
            for (let i = 0; i < sortedDates.length; i++) {
                const dateKey = sortedDates[i];
                const dayHistory = completionHistory[dateKey];
                const completedCount = Object.values(dayHistory).filter(v => v).length;
                
                if (completedCount === taskCount) {
                    currentStreak++;
                    longestStreak = Math.max(longestStreak, currentStreak);
                } else {
                    currentStreak = 0;
                }
            }
            
            // Calculate total completed days
            let completedDays = 0;
            Object.keys(completionHistory).forEach(dateKey => {
                const dayHistory = completionHistory[dateKey];
                const completedCount = Object.values(dayHistory).filter(v => v).length;
                if (completedCount === taskCount) {
                    completedDays++;
                }
            });
            
            const totalHours = completedDays * 3;
            
            document.getElementById('streakCount').textContent = streak;
            document.getElementById('longestStreak').textContent = longestStreak;
            document.getElementById('completedDays').textContent = completedDays;
            document.getElementById('totalHours').textContent = totalHours;
        }

        function exportData() {
            const data = {
                tasks: tasks,
                completionHistory: completionHistory,
                targetData: targetData,
                exportDate: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `german-study-backup-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('‚úÖ Data exported successfully! Save this file in a safe place (Google Drive, USB, etc.)');
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    if (!data.tasks || !data.completionHistory) {
                        alert('‚ùå Invalid backup file format!');
                        return;
                    }
                    
                    if (confirm('‚ö†Ô∏è This will replace all current data. Continue?')) {
                        tasks = data.tasks;
                        completionHistory = data.completionHistory;
                        targetData = data.targetData || null;
                        saveData();
                        
                        if (targetData) {
                            document.getElementById('targetLevel').value = targetData.level;
                            document.getElementById('targetDate').value = targetData.date;
                        }
                        
                        renderTasks();
                        renderCalendar();
                        updateStats();
                        updateTargetDisplay();
                        alert('‚úÖ Data imported successfully!');
                    }
                } catch (error) {
                    alert('‚ùå Error reading backup file. Make sure it\'s a valid JSON file.');
                }
            };
            reader.readAsText(file);
            
            event.target.value = '';
        }

        // Initialize
        loadData();
        renderTasks();
        renderCalendar();
        updateStats();
        updateTargetDisplay();

        document.getElementById('taskInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addTask();
            }
        });
    </script>
</body>
</html>